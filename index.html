<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Dice Roller</title>
<link rel="icon" href="https://cdn.pixabay.com/photo/2017/08/31/04/01/d20-2699387_1280.png" type="image/png">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b0e12;
  --card:#0f1418;
  --muted:#9aa3ae;
  --glass: rgba(255,255,255,0.03);
  --accent: #6ee7b7;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:'Inter',sans-serif;
  background:linear-gradient(180deg,var(--bg), #050607 120%);
  color:#ffffff;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:20px;
}
.app{
  width:900px; max-width:95vw;
  background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);
  border:1px solid rgba(255,255,255,0.03);
  border-radius:18px;
  display:grid; grid-template-columns:350px 1fr;
  gap:24px;
  box-shadow:0 10px 30px rgba(0,0,0,0.6);
  padding:28px;
}
.sidebar{
  padding:18px;
  background:var(--card);
  border-radius:12px;
  border:1px solid rgba(255,255,255,0.02);
}
h1{font-size:20px;margin-bottom:8px}
p.lead{font-size:13px;color:var(--muted);margin-bottom:16px}
label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
button{
  cursor:pointer;
  transition:all 0.3s ease;
}
input, select, button{
  border-radius:10px;
  border:1px solid rgba(255,255,255,0.08);
  background:var(--glass);
  color:#fff;
  font-weight:600;
  padding:10px 12px;
  width:100%;
}
button:hover{background:rgba(255,255,255,0.1);}
option{background:#1a1d22;color:#e6eef6;}
.history{
  margin-top:14px;
  max-height:200px;
  overflow:auto;
  padding-right:6px;
}
.history li{
  list-style:none;
  font-size:13px;
  color:var(--muted);
  margin-bottom:6px;
}

/* === Área de rolagem === */
.roll-area{
  display:flex;
  justify-content:center;
  align-items:center;
}
.stage{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:16px;
}

/* === Dado visual === */
.dice-container{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:18px;
  flex-wrap:wrap;
}
.die{
  position:relative;
  width:100px; height:100px;
  display:flex; align-items:center; justify-content:center;
  font-size:32px; font-weight:700;
  color:#fff;
  box-shadow:0 12px 30px rgba(0,0,0,0.6);
  transform-style:preserve-3d;
  transition:transform 1s cubic-bezier(.22,.9,.35,1);
}
.die span{position:relative;z-index:1;}

.d4{background:linear-gradient(180deg,#06b6d4,#0891b2);
  clip-path:polygon(50% 0%, 0% 100%, 100% 100%);
}
.d6{background:linear-gradient(180deg,#ef4444,#be123c);
  clip-path:polygon(0 0,100% 0,100% 100%,0 100%);
}
.d8{background:linear-gradient(180deg,#fb923c,#ea580c);
  clip-path:polygon(50% 0%, 100% 50%, 50% 100%, 0 50%);
}
.d10{background:linear-gradient(180deg,#facc15,#d97706);
  color:#111;
  clip-path:polygon(50% 0%, 95% 25%, 100% 60%, 50% 100%, 0% 60%, 5% 25%);
}
.d12{background:linear-gradient(180deg,#a78bfa,#6d28d9);
  clip-path:polygon(30% 0,70% 0,100% 30%,100% 70%,70% 100%,30% 100%,0 70%,0 30%);
}
.d20{background:linear-gradient(180deg,#34d399,#059669);
  clip-path:polygon(50% 0%, 90% 20%, 100% 50%, 90% 80%, 50% 100%, 10% 80%, 0% 50%, 10% 20%);
}
.d100{background:linear-gradient(180deg,#60a5fa,#2563eb);
  border-radius:50%;
}

/* === Resultado === */
.result-bubble{
  min-width:70px;
  text-align:center;
  padding:10px 14px;
  border-radius:10px;
  background:rgba(255,255,255,0.04);
  color:var(--accent);
  font-weight:700;
}
.message{
  font-size:14px;
  font-weight:600;
  color:var(--accent);
  height:20px;
  text-align:center;
  transition:opacity 0.3s;
  opacity:0;
}
.message.show{opacity:1}

/* Botões secretos com formatos diferentes */
.secret, .critical{
  position:absolute;
  bottom:10px; 
  width:22px; height:22px;
  border:none;
  cursor:pointer;
  transition:all 0.3s ease;
  opacity:0.6;
}
.secret{
  right:12px;
  background:conic-gradient(from 45deg, #361158, #291242);
  clip-path:polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0 38%);
}
.critical{
  right:42px;
  background:linear-gradient(135deg,#4f5050,#1f2020);
  border-radius:50%;
}
.secret.active, .critical.active {
  opacity:1;
  transform:scale(1.2);
  box-shadow:0 0 10px var(--accent);
}
.secret:hover, .critical:hover{
  filter:brightness(1.3);
}


/* Botões de seleção de dados */
.dice-buttons{
  display:grid;
  grid-template-columns: repeat(4, 1fr);
  gap:8px;
}
.dice-btn{
  padding:8px 10px;
  font-weight:700;
  border-radius:8px;
  border:1px solid rgba(255,255,255,0.1);
  background:rgba(255,255,255,0.04);
}
.dice-btn.active{
  background:var(--accent);
  color:#111;
}

/* === ANIMAÇÃO DE GIRO SUAVE === */
@keyframes smoothSpin {
  0% { transform: rotate(0deg) scale(1); }
  50% { transform: rotate(720deg) scale(1.1); }
  100% { transform: rotate(1440deg) scale(1); }
}
.spin {
  animation: smoothSpin 1.4s cubic-bezier(.22,.9,.35,1);
}
/* === RESPONSIVIDADE MOBILE === */
@media (max-width: 768px) {
  .app {
    display: flex;
    flex-direction: column;
    width: 100%;
    padding: 16px;
  }

  .sidebar {
    order: 2; /* vai para baixo */
    width: 100%;
    padding: 16px;
  }

  .roll-area {
    order: 1;
    width: 100%;
    padding: 16px 0;
  }

  .stage {
    gap: 12px;
  }

  .dice-container {
    gap: 12px;
  }

  .die {
    width: 70px;
    height: 70px;
    font-size: 24px;
  }

  h1 {
    font-size: 18px;
  }

  .lead {
    font-size: 12px;
  }

  .result-bubble {
    font-size: 18px;
    padding: 8px 10px;
  }

  button, input, select {
    font-size: 14px;
    padding: 8px 10px;
  }

  .dice-buttons {
    grid-template-columns: repeat(3, 1fr);
  }

  body {
    height: auto;
    min-height: 100vh;
    align-items: flex-start;
  }
}

</style>

<style>
:root {
  --bg: #0b0e12;
  --card: #14191f;
  --accent: #6ee7b7;
  --highlight: #38bdf8;
  --muted: #a1a1aa;
}

body {
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: #fff;
  font-family: 'Inter', sans-serif;
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
}

/* === PAINEL DE INICIATIVA === */
#initiative-panel {
  width: 100%;
  max-width: 900px;
  background: var(--card);
  border-bottom: 1px solid rgba(255,255,255,0.1);
  box-shadow: 0 2px 10px rgba(0,0,0,0.4);
  padding: 12px 16px;
  position: sticky;
  top: 0;
  z-index: 10;
  border-radius: 16px;
  margin-bottom: 50px;
}

#initiative-panel h2 {
  font-size: 16px;
  margin-bottom: 8px;
  text-align: center;
  letter-spacing: 1px;
  color: var(--accent);
}

#initiative-list {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 8px;
}

.initiative-item {
  display: flex;
  align-items: center;
  gap: 6px;
  background: rgba(255,255,255,0.05);
  padding: 6px 10px;
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,0.1);
  transition: all 0.3s ease;
}

.initiative-item.active {
  border: 2px solid var(--highlight);
  box-shadow: 0 0 12px var(--highlight);
  background: rgba(56,189,248,0.1);
  transform: scale(1.05);
}

.initiative-item input[type="text"],
.initiative-item input[type="number"] {
  background: transparent;
  border: none;
  outline: none;
  color: #fff;
  font-size: 14px;
  text-align: center;
}

.initiative-item input[type="text"] {
  width: 100px;
}

.initiative-item input[type="number"] {
  width: 60px;
}

button {
  background: var(--accent);
  color: #111;
  font-weight: 700;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  padding: 8px 12px;
  transition: all 0.2s ease;
}
button:hover {
  filter: brightness(1.2);
}

#initiative-controls {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-top: 8px;
}

/* === ROLADOR CENTRAL === */
main {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 100%;
}

main h1 {
  color: var(--muted);
  font-size: 20px;
  text-align: center;
}

/* === MOBILE === */
@media (max-width: 768px) {
  #initiative-list {
    flex-direction: column;
    align-items: stretch;
  }
  .initiative-item {
    justify-content: space-between;
  }
}
</style>


</head>
<body>

<!-- PAINEL DE INICIATIVA -->
<div id="initiative-panel">
  <h2>⚔️ Ordem de Iniciativa</h2>
  <div id="initiative-list"></div>
  <div id="initiative-controls">
    <button id="addBtn">Adicionar</button>
    <button id="sortBtn">Ordenar</button>
    <button id="startBtn">Iniciar</button>
    <button id="nextBtn" disabled>Próximo</button>
    <button id="clearBtn">Limpar</button>
  </div>
</div>

<!-- ÁREA CENTRAL -->
<script>
const initiativeList = document.getElementById('initiative-list');
const addBtn = document.getElementById('addBtn');
const sortBtn = document.getElementById('sortBtn');
const startBtn = document.getElementById('startBtn');
const nextBtn = document.getElementById('nextBtn');
const clearBtn = document.getElementById('clearBtn');

let participants = [];
let currentTurn = -1;
let combatActive = false;

// Cria um novo campo de iniciativa
function addParticipant(name = "", initiative = "") {
  const item = document.createElement('div');
  item.className = 'initiative-item';
  item.innerHTML = `
    <input type="text" placeholder="Nome" value="${name}">
    <input type="number" placeholder="Ini" value="${initiative}">
    <button class="removeBtn">✖</button>
  `;
  item.querySelector('.removeBtn').addEventListener('click', () => {
    item.remove();
    updateList();
  });
  initiativeList.appendChild(item);
  updateList();
}

// Atualiza a lista de participantes
function updateList() {
  participants = Array.from(initiativeList.children).map(item => ({
    name: item.querySelector('input[type="text"]').value.trim() || "—",
    initiative: parseInt(item.querySelector('input[type="number"]').value) || 0,
    element: item
  }));
}

// Ordena participantes
function sortParticipants() {
  updateList();
  participants.sort((a, b) => b.initiative - a.initiative);
  initiativeList.innerHTML = "";
  participants.forEach(p => initiativeList.appendChild(p.element));
}

// Inicia o combate
function startCombat() {
  if (participants.length === 0) return;
  sortParticipants();
  combatActive = true;
  currentTurn = 0;
  highlightTurn();
  startBtn.disabled = true;
  nextBtn.disabled = false;
}

// Avança para o próximo turno
function nextTurn() {
  if (!combatActive) return;
  participants[currentTurn].element.classList.remove('active');
  currentTurn = (currentTurn + 1) % participants.length;
  highlightTurn();
}

// Destaca o jogador da vez
function highlightTurn() {
  participants.forEach(p => p.element.classList.remove('active'));
  const current = participants[currentTurn];
  current.element.classList.add('active');
  // rolar até ele (útil em mobile)
  current.element.scrollIntoView({ behavior: 'smooth', block: 'center' });
}

// Limpa tudo
function clearAll() {
  initiativeList.innerHTML = "";
  participants = [];
  combatActive = false;
  currentTurn = -1;
  startBtn.disabled = false;
  nextBtn.disabled = true;
}

// Eventos
addBtn.addEventListener('click', () => addParticipant());
sortBtn.addEventListener('click', sortParticipants);
startBtn.addEventListener('click', startCombat);
nextBtn.addEventListener('click', nextTurn);
clearBtn.addEventListener('click', clearAll);
initiativeList.addEventListener('input', updateList);
</script>




<div class="app">
  <!-- Área principal -->
  <div class="roll-area">
    <div class="stage">
      <div id="diceContainer" class="dice-container">
        <div class="die d20"><span>d20</span></div>
      </div>
      <div style="display:flex;gap:10px;align-items:center;">
        <div id="result" class="result-bubble">—</div>
        <button id="rollBtn">Rolar</button>
      </div>
      <div id="message" class="message"></div>
      <small style="color:var(--muted);font-size:13px;">Pressione Enter para rolar</small>
      <button class="critical" id="criticalBtn" title="modo crítico"></button>
      <button class="secret" id="secretBtn" title="modo de sorte"></button>
    </div>
  </div>

  <!-- Painel lateral -->
  <aside class="sidebar">
    <h1>Rolagem de Dados</h1>
    <p class="lead">Selecione os dados que deseja rolar.</p>

    <div class="dice-buttons" id="diceButtons">
      <button class="dice-btn" data-sides="4">d4</button>
      <button class="dice-btn" data-sides="6">d6</button>
      <button class="dice-btn" data-sides="8">d8</button>
      <button class="dice-btn" data-sides="10">d10</button>
      <button class="dice-btn" data-sides="12">d12</button>
      <button class="dice-btn active" data-sides="20">d20</button>
      <button class="dice-btn" data-sides="100">d100</button>
    </div>

    <div style="margin-top:16px;display:grid;gap:12px;">
      <div>
        <label for="mode">Modo</label>
        <select id="mode">
          <option value="normal" selected>Normal</option>
          <option value="vantagem">Vantagem</option>
          <option value="desvantagem">Desvantagem</option>
        </select>
      </div>

      <div>
        <label for="qty">Quantidade de dados</label>
        <input type="number" id="qty" min="1" value="1">
      </div>

      <div>
        <label for="mod">Modificador</label>
        <input type="number" id="mod" value="0">
      </div>
    </div>

    <ul id="history" class="history"></ul>
  </aside>
</div>

<script>
const diceContainer = document.getElementById('diceContainer');
const rollBtn = document.getElementById('rollBtn');
const mode = document.getElementById('mode');
const qty = document.getElementById('qty');
const mod = document.getElementById('mod');
const historyEl = document.getElementById('history');
const resultEl = document.getElementById('result');
const messageEl = document.getElementById('message');
const secretBtn = document.getElementById('secretBtn');
const criticalBtn = document.getElementById('criticalBtn');
const diceButtons = document.querySelectorAll('.dice-btn');

let luckyMode = false;
let criticalMode = false;
let selectedDice = [20];

secretBtn.addEventListener('click', ()=>{
  luckyMode = !luckyMode;
  secretBtn.classList.toggle('active', luckyMode);
});
criticalBtn.addEventListener('click', ()=>{
  criticalMode = !criticalMode;
  criticalBtn.classList.toggle('active', criticalMode);
});

// Seleção múltipla e pré-visualização
diceButtons.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const sides = parseInt(btn.dataset.sides);
    btn.classList.toggle('active');
    if(selectedDice.includes(sides)){
      selectedDice = selectedDice.filter(s=>s!==sides);
    }else{
      selectedDice.push(sides);
    }
    previewDice();
  });
});

qty.addEventListener('input', previewDice);

function previewDice(){
  diceContainer.innerHTML = "";
  const qtyVal = Math.max(1, parseInt(qty.value));
  selectedDice.forEach(sides=>{
    for(let i=0;i<qtyVal;i++){
      const die = document.createElement('div');
      die.className = `die d${sides}`;
      die.innerHTML = `<span>d${sides}</span>`;
      diceContainer.appendChild(die);
    }
  });
}

function rollOnce(sides){
  if(criticalMode && sides===20) return 20;
  if(luckyMode){
    const min = Math.floor(sides * 0.8);
    return Math.floor(Math.random() * (sides - min + 1)) + min;
  }
  return Math.floor(Math.random() * sides) + 1;
}

function animateDice(diceEls){
  diceEls.forEach(die=>{
    die.classList.remove('spin');
    void die.offsetWidth;
    die.classList.add('spin');
  });
}

function rollDice(){
  diceContainer.innerHTML = "";
  const modeVal = mode.value;
  const qtyVal = Math.max(1, parseInt(qty.value));
  const modVal = parseInt(mod.value) || 0;


  let total = 0;
  let details = [];
  let criticalMsg = "";

  selectedDice.forEach(sides=>{
    const diceCount = (modeVal === 'vantagem' || modeVal === 'desvantagem') ? 2 : qtyVal;
    let rolls = [];

    for(let i=0;i<diceCount;i++) rolls.push(rollOnce(sides));

    let result;
    if(modeVal === 'vantagem') result = Math.max(...rolls);
    else if(modeVal === 'desvantagem') result = Math.min(...rolls);
    else result = rolls.reduce((a,b)=>a+b,0);

    total += result;
    details.push(`d${sides}(${rolls.join(',')})`);

    // mostra visualmente todos os dados rolados
    rolls.forEach(val=>{
      const die = document.createElement('div');
      die.className = `die d${sides}`;
      die.innerHTML = `<span>${val}</span>`;
      diceContainer.appendChild(die);
    });

    if(sides===20){
      if(result===1) criticalMsg = "Falha Crítica ☠️";
      else if(result===20) criticalMsg = "Sucesso Crítico ✨";
    }
  });

  const diceEls = document.querySelectorAll('.die');
  animateDice(diceEls);

  setTimeout(()=>{
    total += modVal;
    resultEl.textContent = total;
    if(criticalMsg){
      messageEl.textContent = criticalMsg;
      messageEl.classList.add('show');
      setTimeout(()=>messageEl.classList.remove('show'),3000);
    }
    addHistory(details, modVal, total, modeVal);
  },1400);
}

function addHistory(details, mod, total, mode){
  const li = document.createElement('li');
  li.textContent = `${new Date().toLocaleTimeString()} — ${details.join(' + ')} +${mod} = ${total}`;
  historyEl.prepend(li);
  while(historyEl.children.length>30) historyEl.removeChild(historyEl.lastChild);
}

rollBtn.addEventListener('click', rollDice);
window.addEventListener('keydown', e=>{ if(e.key==='Enter') rollDice(); });

// inicializa preview
previewDice();
</script>



</body>
</html>
